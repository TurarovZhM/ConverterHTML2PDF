<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="search/image/favicon.ico">
<title>CorrectionPressureAlgorithm</title>
<link href="search/css/bootstrap.css" rel="stylesheet">
<link href="search/css/fraunhofer.css" rel="stylesheet">
<script type="text/javascript" src="search/js/jquery-1.12.0.js"></script>
<script src="search/js/bootstrap.min.js"></script>
<script src="search/js/custom.js"></script>
</head>
<body>
	<div class="fh-wrapper">
		<div class="header">
			<div class="row visible-xs" id="main-menu-top">
				    <div class="row search-nav-icon">
					    <div class="col-md-12">
					<!-- for search and navigation icon -->
						  <div id="nav-top" class="nav-top-btn"></div>
						  <div id="search-btn-index-top-icon" class="search-icon"></div>
					    </div>
				    </div>
				    <div class="row">
				      <div class="col-md-12">
					    <nav class="navbar navbar-inverse">
						    <div class="navbar-header">
						      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						      </button>
						    </div>
							<div id="navbar" class="navbar navbar-light bg-faded collapse navbar-collapse">
							  <ul class="nav navbar-nav">
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.InputFiles.html" target="_blank">Input Files</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Indices.html" target="_blank">Indices</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.GettingStarted.html" target="_blank">Getting Started</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Download.html" target="_blank">Download</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Support.html" target="_blank">Support</a>
								</li>
							  </ul>
							</div>
					      </nav>
					</div>
				      <div class="search-top">
					      <form id="search-form-index-top" >
						  <input type="text" name="queryString" id="search-text-index-top" value="" autocomplete="off" placeholder="Search" class="query-string"/>
						  <button type="submit" class="btn" id="search-btn-index-top"></button>
					      </form>
				    </div>
				</div>
			</div>
			<div class="row header-row">
				<div class="col-sm-4">
					<div class="row">
					   <a href="MESHFREE.html">
						  <img class="logo img-responsive" alt="" src="search/image/MESHFREE_Logo.png"/>
					   </a>
					</div>
					<div class= "row company_name">
						Simulate with complex geometries and complex physics
					</div>
				</div>
				<div class="col-sm-8">
					<div class="row header-search-row hidden-xs">
						<div class="search">
						  <form id="search-form-index-header" >
						      <input type="text" name="queryString" id="search-text-index-header" value="" autocomplete="off" placeholder="Search" class="query-string"/>
						      <button type="submit" class="btn" id="search-btn-index-header"><i class="glyphicon glyphicon-search"></i></button>
						  </form>
						</div>
					</div>
					<div class="row main_menu hidden-xs" id="main-menu-bottom">
					  <nav class="navbar navbar-inverse">
						<div class="navbar-header">
						  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						    <span class="sr-only">Toggle navigation</span>
						    <span class="icon-bar"></span>
						    <span class="icon-bar"></span>
						    <span class="icon-bar"></span>
						  </button>
						</div>
							<div id="navbar" class="navbar navbar-light bg-faded collapse navbar-collapse">
							  <ul class="nav navbar-nav">
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.InputFiles.html" target="_blank">Input Files</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Indices.html" target="_blank">Indices</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.GettingStarted.html" target="_blank">Getting Started</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Download.html" target="_blank">Download</a>
								</li>
								<li class="nav-item">
								  <a class="nav-link" href="MESHFREE.Support.html" target="_blank">Support</a>
								</li>
							  </ul>
							</div>
					  </nav>
					</div>
				</div>
			</div>
		</div>
     <div class="breadcrumbs">
	  <div class="row breadcrumb">
	    <div class="col-md-12">
		<ul>
<li><a href="MESHFREE.html">MESHFREE</a></li>
<li><a href="MESHFREE.Solvers.html">Solvers</a></li>
<li><a href="MESHFREE.Solvers.Numerics.html">Numerics</a></li>
<li><a href="MESHFREE.Solvers.Numerics.LIQUID.html">LIQUID</a></li>
<li><a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.html">Algorithms</a></li>
<li><a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.CorrectionPressureAlgorithm.html">CorrectionPressureAlgorithm</a></li>
		</ul>
	    </div>
	  </div>
	</div>
		<div class="border-vertical">
		  <div class="row">
		    <div class="col-md-12 content">
		    	<div class="jumbotron">
<h1>CorrectionPressureAlgorithm</h1><p> compute the correction pressure according to a Chorin-like correction ansatz </p>
		    	</div>
			<div class="description">
                                                                                                                                                                               
  Let us suppose we have a velocity field <span lang="latex-inline"><img src="8e927923156b6cb05e47233da3a7960a.png" alt=" \mathbf{\tilde{v}}_{{}}^{n+1}" class="latex" border="0"></span> that stems from the numerical integration of the 
  momentum equation (see EquationsToSOlve), i.e. we have computed 
  <div lang="latex"><img src="3a2803fc7135ada6cb5ff7501c3bdb92.png" alt=" \frac{\mathbf{\tilde{v}}_{{}}^{n+1}-\mathbf{v}_{{}}^{n}}{\Delta t}+\frac{1}{\rho }\nabla p_{{}}^{n}=\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{s}^{n} \right)_{{}}^{T}+\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{\tilde{v}}_{{}}^{n+1} \right) \right)_{{}}^{T}+\mathbf{g}-\beta \cdot \mathbf{\tilde{v}}_{{}}^{n+1}" class="latex" border="0"></div> 
  The resulting velocity field <span lang="latex-inline"><img src="8e927923156b6cb05e47233da3a7960a.png" alt=" \mathbf{\tilde{v}}_{{}}^{n+1}" class="latex" border="0"></span> does most probably not provide the correct value of 
  divergence of velocity <span lang="latex-inline"><img src="8d5c5bb7524ee456c682556d2f7a9c4f.png" alt=" \nabla _{{}}^{T}\mathbf{\tilde{v}}_{{}}^{n+1}" class="latex" border="0"></span> . Let us suppose there is a correction to the pressure <span lang="latex-inline"><img src="4ffb1cef4457f1fe42156f6271559504.png" alt=" c" class="latex" border="0"></span> 
  that exactly leads to the correct divergence, that is 
  <div lang="latex"><img src="4d20171105623fd7f647aed59987e09e.png" alt=" \frac{\mathbf{v}_{{}}^{n+1}-\mathbf{v}_{{}}^{n}}{\Delta t}+\frac{1}{\rho }\nabla p_{{}}^{n}+\frac{1}{\rho }\nabla c=\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{s}^{n} \right)_{{}}^{T}+\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{v}_{{}}^{n+1} \right) \right)_{{}}^{T}+\mathbf{g}-\beta \cdot \mathbf{v}_{{}}^{n+1}" class="latex" border="0"></div> 
  With the presumption that <span lang="latex-inline"><img src="c873cbfdcad084f6513c78a3692c9cb7.png" alt=" \nabla _{{}}^{T}\mathbf{v}_{{}}^{n+1}" class="latex" border="0"></span> has the correct value. In order to find the correction 
  pressure <span lang="latex-inline"><img src="4ffb1cef4457f1fe42156f6271559504.png" alt=" c" class="latex" border="0"></span> we subtract the two equations from one another, that is 
  <div lang="latex"><img src="475f9af0b6c366a729552fbda430a2fa.png" alt=" \left( \frac{1+\Delta t\beta }{\Delta t} \right)\cdot \left( \mathbf{v}_{{}}^{n+1}-\mathbf{\tilde{v}}_{{}}^{n+1} \right)+\frac{1}{\rho }\nabla c=+\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{v}_{{}}^{n+1} \right) \right)_{{}}^{T}-\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{\tilde{v}}_{{}}^{n+1} \right) \right)_{{}}^{T}" class="latex" border="0"></div> 
  Written in another way, we have 
  <div lang="latex"><img src="1c45c5bd1b750fbec52935854da23b93.png" alt=" \left( \mathbf{v}_{{}}^{n+1}-\mathbf{\tilde{v}}_{{}}^{n+1} \right)+\left( \frac{\Delta t}{1+\Delta t\beta } \right)\frac{1}{\rho }\nabla c=\left( \frac{\Delta t}{1+\Delta t\beta } \right)\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{v}_{{}}^{n+1} \right) \right)_{{}}^{T}-\left( \frac{\Delta t}{1+\Delta t\beta } \right)\frac{1}{\rho }\left( \nabla _{{}}^{T}\mathbf{S}_{v}^{{}}\left( \mathbf{\tilde{v}}_{{}}^{n+1} \right) \right)_{{}}^{T}" class="latex" border="0"></div> 
  For incompressible problems with constant viscosity, we can simplify 
  <div lang="latex"><img src="1b59599825a8b1b0f3bb5ee226ab65e4.png" alt=" \left( \mathbf{v}_{{}}^{n+1}-\mathbf{\tilde{v}}_{{}}^{n+1} \right)+\left( \frac{\Delta t}{1+\Delta t\beta } \right)\frac{1}{\rho }\nabla c=\left( \frac{\Delta t}{1+\Delta t\beta } \right)\frac{\eta }{\rho }\Delta \left( \mathbf{v}_{{}}^{n+1}-\mathbf{\tilde{v}}_{{}}^{n+1} \right)" class="latex" border="0"></div> 
   
  The correction pressure stems from the simplified correction ansatz of a given velocity field (marked by tilde) towards 
  a velocity field with a desired divergence of velocity. 
  <div lang="latex"><img src="f365d2f33a0384cddee70f6e7033eff6.png" alt=" \mathbf{v}_{{}}^{n+1}=\mathbf{\tilde{v}}_{{}}^{n+1}-\frac{\Delta t_{virt}^{{}}}{\left( 1+\Delta t_{\beta }^{{}}\cdot \beta  \right)}\frac{1}{\rho }\nabla c" class="latex" border="0"></div> 
  For the term <span lang="latex-inline"><img src="95eab8c4569eaeb4076e802ac50dccda.png" alt=" \Delta t_{virt}" class="latex" border="0"></span> see <a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.CorrectionPressureAlgorithm.VirtualTimeStepSize.html">VirtualTimeStepSize</a>. 
   
  By application of the divergence operator from left, we obtain 
  <div lang="latex"><img src="747737df7965693b16969db0799debdb.png" alt=" \left( \nabla _{{}}^{T}\mathbf{v}_{{}}^{n+1} \right)_{target}^{{}}-\nabla _{{}}^{T}\mathbf{\tilde{v}}_{{}}^{n+1}+\nabla _{{}}^{T}\left( \frac{\Delta t_{virt}^{{}}}{\left( 1+\Delta t_{\beta }^{{}}\cdot \beta  \right)}\frac{1}{\rho }\nabla c \right)=0" class="latex" border="0"></div> 
  The desired divergence of the velocity is depending on the compressibility of the fluid as well as on temporal changes of the density due to other effects 
  such as chemical reaction, expansion due to heating, etc. 
   
  Derivation of this term is found in <a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.CorrectionPressureAlgorithm.DesiredAndNominalDivergenceOfVelocity.html">DesiredAndNominalDivergenceOfVelocity</a>. 
   
  Having a formulation for the divergence of velocity, the equation to be solved for the correction pressure is 
  <div lang="latex"><img src="53465c893b703862a4b63929e48b751e.png" alt=" -\frac{1}{\rho }\frac{\partial \rho }{\partial p}\frac{1}{\Delta t}c+\nabla _{{}}^{T}\left( \frac{\Delta t_{virt}^{{}}}{\left( 1+\Delta t_{\beta }^{{}}\cdot \beta  \right)}\frac{1}{\rho }\nabla c \right)-\nabla _{{}}^{T}\mathbf{\tilde{v}}_{{}}^{n+1}=-\left( \overline{\nabla _{{}}^{T}\mathbf{v}} \right)_{c}^{n+1}" class="latex" border="0"></div> 
  which numerically leads to the (linear) system to be solved 
  <div lang="latex"><img src="a4fe46e61bcd502f2710b4b6159aab7b.png" alt=" -\frac{1}{\rho }\frac{\partial \rho }{\partial p}\frac{1}{\Delta t}c_{i}^{{}}+\sum\limits_{j}^{{}}{d_{ij}^{\nabla _{{}}^{T}\left( \frac{\Delta t_{virt}^{{}}}{\left( 1+\Delta t_{\beta }^{{}}\cdot \beta  \right)}\frac{1}{\rho }\nabla  \right)}}\cdot c_{ij}^{{}}-\nabla _{{}}^{T}\mathbf{\tilde{v}}_{{}}^{n+1}=-\left( \overline{\nabla _{{}}^{T}\mathbf{v}} \right)_{c}^{n+1}" class="latex" border="0"></div> 
  The result of this equation is stored in <a href="MESHFREE.Indices.LIQUID___indices___.%25ind_c%25.html">%ind_c%</a> . 
                
	      			</div>
	      		</div>
		</div>
	</div>
<div class="blank-class-outer-top">
	<div class="border-vertical">
		<div class="row reference">
	      		<div class="col-md-12">
		 		<div class="table-responsive">
			  		<table class="table">
			  		<tr><th>List of members: </th><th></th></tr>
<tr><td><a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.CorrectionPressureAlgorithm.DesiredAndNominalDivergenceOfVelocity.html">DesiredAndNominalDivergenceOfVelocity</a></td> <td>  derive a formulation for the desired divergence of velocity </td></tr>    
<tr><td><a href="MESHFREE.Solvers.Numerics.LIQUID.Algorithms___liquid___.CorrectionPressureAlgorithm.VirtualTimeStepSize.html">VirtualTimeStepSize</a></td> <td>  virtual time step size to control the correction pressure or the divergence of velocity </td></tr>    
		  			</table>
				</div>
	      		</div>
		</div>
	</div>
</div>
<div class="blank-class-outer footer visible-md visible-lg">
  <div class="border-vertical">
    <div class="row">
	      <div class="col-md-6">
		      <a href="http://itwm.fraunhofer.de" target="_blank">&copy 2020 Fraunhofer Institute for Industrial Mathematics ITWM</a>
	      </div>
	      <div class="col-md-2 footer-border-left">
			<a href="Index.html" target="_blank">Index</a>
	      </div>
	      <div class="col-md-2 footer-border-left">
			<a href="MESHFREE.Releases.html" target="_blank">Releases</a>
	      </div>
	      <div class="col-md-2 footer-border-left">
			<a href="https://svn.itwm.fraunhofer.de/svn/MESHFREEdocu/Executables/" target="_blank">Executables</a>
	      </div>
      </div>
    </div>
  </div>
  <div class="footer-small visible-xs visible-sm">
    <div class="blank-class-outer">
      <div class="blank-class-inner">
	<div class="row ">
		<div class="col-md-12">
			<a href="Index.html" target="_blank">Index</a>
	      </div>
	</div>
      </div>
    </div>
    <div class="blank-class-outer-bottom">
      <div class="blank-class-inner">
	<div class="row ">
	      <div class="col-md-12">
		      <a href="MESHFREE.Releases.html" target="_blank">Releases</a>
	      </div>
	</div>
      </div>
    </div>
    <div class="blank-class-outer-bottom">
      <div class="blank-class-inner">
	<div class="row ">
	      <div class="col-md-12">
		      <a href="https://svn.itwm.fraunhofer.de/svn/MESHFREEdocu/Executables/" target="_blank">Executables</a>
	      </div>
	</div>
      </div>
    </div>
    <div class="blank-class-outer-left-right">
      <div class="blank-class-inner">
	<div class="row ">
	      <div class="col-md-12">
		      <a href="http://itwm.fraunhofer.de" target="_blank">&copy 2020 Fraunhofer Institute for Industrial Mathematics ITWM</a>
	      </div>
	</div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
